# SortOV - Сортировка вентсистем

## Описание

Скрипт `SortOV_script.py` предназначен для сортировки и нумерации систем воздуховодов в Autodesk Revit по порядку от "П" к "ДВ" . Он добавляет числовой префикс к параметру "Имя системы" каждой системы, начиная с 1, и обновляет соответствующие элементы (воздуховоды, фиттинги и т.д.), чтобы обеспечить последовательную нумерацию.

## Инструкция

1. Откройте активный документ Revit, содержащий системы воздуховодов.
2. Запустите скрипт, нажав на кнопку "SortOV" в панели "ОВиК" вкладки pyScript.
3. Скрипт автоматически:
   - Соберет все системы воздуховодов в документе.
   - Отсортирует их по порядку: ПЕ, ВЕ, ДПЕ, ДВЕ, П, В, ДП, ДВ, А, У (на основе префикса имени системы).
   - Добавит числовой префикс (например, "1. Приточная система") к параметру "Имя системы".
   - Обновит параметр "ADSK_Группирование" для систем и "ИмяСистемы" для элементов.
4. Просмотрите результаты в консоли (выводится список систем с новым именем и количеством элементов).
5. Проверьте изменения в проекте. Если необходимо, отмените транзакцию через Undo в Revit.

## Примечания

- Скрипт работает только с элементами категории "Системы воздуховодов" и связанными элементами (воздуховоды, фиттинги и т.д.).
- Использует параметры "Имя системы", "ADSK_Группирование" и "ИмяСистемы" для элементов.
- Сортировка основана на префиксе имени системы (ПЕ, ВЕ и т.д.); если префикс не найден, элемент идет последним.
- Числовые индексы извлекаются из имени после префикса.
- Все изменения выполняются в транзакции Revit для обеспечения возможности отмены.
- Если параметр доступен только для чтения, обновление пропускается.
- Для элементов в сети системы обновляется параметр "ИмяСистемы", если он редактируемый.

## Автор

Разработано Rage.

## Версия

1.0
