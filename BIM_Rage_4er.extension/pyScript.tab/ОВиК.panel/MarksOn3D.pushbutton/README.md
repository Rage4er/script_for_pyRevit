# MarksOn3D - Автоматическое размещение марок на 3D-видах

## Описание

Скрипт `MarksOn3D_script.py` предназначен для автоматического размещения марок (аннотаций) на элементах в выбранных 3D-видах Autodesk Revit. Скрипт анализирует элементы по категориям, находит подходящие семейства марок, размещает марку с учетом смещения и ведет логирование процесса. Это полезно для быстрого аннотирования элементов на 3D-моделях.

## Инструкция

1. Откройте активный документ Revit.
2. Запустите скрипт, нажав на кнопку "MarksOn3D" в панели "ОВиК" вкладки pyScript.
3. В появившемся окне мастера следуйте вкладкам:
   - **Вкладка 1**: Выберите виды для обработки (только 3D-виды). Используйте поиск, выбор всех или снятие всего.
   - **Вкладка 2**: Включите/отключите логирование.
   - **Вкладка 3**: Выберите категории элементов для маркировки.
   - **Вкладка 4**: Выберите семейства марок для каждой категории (используйте двойной клик для выбора типа марки).
   - **Вкладка 5**: Просмотрите сводку выбранных настроек и нажмите "Выполнить".
4. Скрипт автоматически разместит марку на каждом подходящем элементе в выбранных видах:
   - Марки размещаются с смещением по X и Y.
   - Проверяется наличие существующей марки; новые размещаются только если нет дубликатов.
   - Если семейство марки не найдено, элемент пропускается.
5. Просмотрите логи (если включено) и изменения на видах. При необходимости отмените через Undo в Revit.
6. Для просмотра логов нажмите "Показать логи" в окне.

## Примечания

- Скрипт использует файл `tag_defaults.json` для сохранения и загрузки настроек марок по умолчанию.
- Работает в транзакции Revit для обеспечения возможности отмены.
- Поддерживает только 3D-виды (другие виды пропускаются).
- Логирование выводится в отдельном окне, включая детали по каждому элементу.
- Если элемент уже имеет марку, новая не размещается (проверяется по наличию тега).
- Категории и семейства марок зависят от загруженных семейств в проекте.

## Автор

Разработано Rage.

## Версия

1.0
