нужен код для pyrevit, прежде чем писать, задавай все необходимые уточняющие вопросы, пиши по пунктам. Скрипт должен выдавать по шагам:
1. список всех 3д видов для фильтрации пользователем
2. на выбранных видах собирать информацию о категориях видимых элементов, составлять список этих категорий для фильтрации пользователем
3. предоставить выбор семейств марок для каждой из выбранных категорий соответственно
4. проставить на выбранных видах выбранные семейства марки по выбранным ранее категориям

Вопросы есть?


1. Тип марок - Марки элементов (Family Tags) для конкретных категорий

2. Стратегия размещения - Рядом с элементом на заданном расстоянии по x,y в мм

3. Обработка дубликатов - Ставить марку на всех видах

4. Фильтрация элементов - Только определенные подкатегории

5. Настройки марок - Ориентация марки (горизонтальная/вертикальная), С привязкой к элементу, С определенным смещением

6. Обработка ошибок :
Элемент уже имеет марку на виде- игнорировать элемент
Нет подходящего семейства марки для категории- игнорировать категорию
Вид не поддерживает маркирование- игнорировать вид
Вывести уведомление об ошибках перед продолжением скрипта

7. Интерфейс пользователя - Окно с кнопками и списками

Смещение: X=60, Y=30 мм

Ориентация: горизонтальная

Подкатегории: показывать только те, что есть в выбранных видах



   
   
1. во второй вкладке расписаны категории каждого элемента, необходимо оставить список уникальных категорий для выбора, применяя к каждому элементу категории на виде
2. не возможно изменить марку в списке на третьей вкладке

1. название всех 3д видов в списке выбора одинаковое autodesk.revit.db.view3d