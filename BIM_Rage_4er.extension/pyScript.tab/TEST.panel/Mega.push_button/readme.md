Предложения:**
- **Начать с простого варианта:** Реализовать логику для **одного выделенного элемента** (как в плане), чтобы протестировать поиск по спирали. Потом расширить на несколько элементов.
- **Выбор марки:** Использовать стандартную марку для воздуховодов (BuiltInCategory.OST_DuctTags). Найдём первое доступное семейство символов через `FilteredElementCollector`. Если нужно конкретное (например, "Дутовая марка" или с типом "Горизонтальная"), можно hardcode или добавить выбор.
- **Параметр марки:** По умолчанию — "Имя системы" (System Name). Если нужен другой (размер, тип), уточните.
- **BoundingBox:** Для элемента использовать `element.get_BoundingBox(view)` (Outline), но на плоскостном виде это 3D-объём. Для простоты спроецируем min/max точки на вид (используя `view.GetOrientation()` и преобразования). Если это не точно, можно использовать геометрию элемента и вычислить видимый bbox вручную (но это сложнее; Revit не даёт прямого API для 2D-bbox на виде).
- **Поиск по спирали:** Шаг — 1 фут (0.3048 м, стандарт Revit). Смещение от bbox элемента: фиксированное расстояние (например, 1 фут вправо-вверх от центра). Спектр поисков: от 1 до 10 шагов (чтобы не уйти далеко; ~10-20 итераций).
- **Опционально:** Для CV (OpenCV) добавим как fallback: если спираль не найдёт место после N попыток, вызвать внешний Python-скрипт. Но начнём без него, чтобы не усложнять.
- **Производительность:** Для больших видов кэшировать bbox существующих элементов. Использовать `FilteredElementCollector` с фильтрами по категории и виду.
- **Тестирование:** В Revit создайте простой вид с воздуховодами, выделите один, запустите скрипт. Проверьте размещение и отсутствие пересечений. Если нет Revit у вас, я напишу код так, чтобы он был модульным для отладки.

**Вопросы:**
1. **Тип марки:** Какое семейство использовать? (Например, имя семейства или тип — "HVAC Duct Tags"?) Если стандартное, ок.
2. **Параметр:** Что должна показывать марка? "Имя системы" или размер/тип элемента?
3. **Ориентация марки:** Горизонтальная или вертикальная? (Влияет на bbox проверки.)
4. **Фиксированное расстояние:** Сколько футов/метров от bbox элемента начать поиск? (Например, 1 фут.)
5. **Шаг спирали:** 1 фут, ок? Максимальное количество попыток? (Чтобы не зациклить.)
6. **Количество элементов:** Только один или все выделенные? Если все, обрабатывать последовательно?
7. **Вид:** Только плоскостные виды? Или 3D тоже (где поиск сложнее)?
8. **CV-интеграция:** Начинать без неё? Или сразу добавить? (Требуется subprocess.call для внешнего скрипта.)
9. **Иконка и метаданные:** Нужно добавить README и icon.png? Текст: "Умное размещение марок для воздуховодов с поиском свободного места"?